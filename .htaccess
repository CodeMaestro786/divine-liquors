RewriteEngine On
RewriteBase /

# Prevent directory listing
Options -Indexes

# Redirect to HTTPS
RewriteCond %{HTTPS} off
RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# Pretty URLs
RewriteRule ^products/([0-9]+)/?$ product.php?id=$1 [NC,L]
RewriteRule ^cart/?$ cart.php [NC,L]
RewriteRule ^checkout/?$ checkout.php [NC,L]

# Protect admin directory
<FilesMatch "\.(php|html)$">
    AuthType Basic
    AuthName "Admin Area"
    AuthUserFile /path/to/.htpasswd
    Require valid-user
</FilesMatch>